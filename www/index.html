<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />

      <link href="lib/ionic/css/ionic.css" rel="stylesheet">

      <script src="lib/ionic/js/ionic.bundle.js"></script>
      <script src="lib/ionic-platform-web-client/dist/ionic.io.bundle.js"></script>

      <link href="css/style.css" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.0/mapsjs-ui.css">
      <script href="www/css/ionicons.css" rel="stylesheet"></script>

      <script src="cordova.js"></script>
      <script src="lib/ngCordova/dist/ng-cordova.js"></script>
      <script src="js/app.js"></script>
      <script src="js/controllers.js"></script>
      <script src="js/factories/MapFactory.js"></script>

      <script src="https://js.api.here.com/v3/3.0/mapsjs-core.js"></script>
      <script src="https://js.api.here.com/v3/3.0/mapsjs-service.js"></script>
      <script src="https://js.api.here.com/v3/3.0/mapsjs-ui.js"></script>
      <script src="https://js.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>
  </head>
  <ion-view title="Map">
     <ion-content>

      <body ng-app="noParks">
        <ion-header-bar class="bar bar-header bar-dark">
          <h1 class="title">No Parks After Dark</h1>
        </ion-header-bar>

        <br>

        <div ng-controller="MapController as ctrl">
          <div id="mapContainer" style="width: 640px; height: 380px"></div>
            <br>
            <ion-scroll zooming="true" direction="y" style="width: 500px; height: 100px">
              <div id="routeInstructionsContainer" font="white"></div>
            </ion-scroll>
            <br>
            <div class="list">
              <div id="locationField" ng-controller="MapController as ctrl">
                <label class="item item-input">
                  <input class="autocomplete"  type="text" ng-model="userStart" placeholder="Start Location" onfocus="geolocate()">
                </label>
                <label class="item item-input">
                  <input class="autocomplete" id="ac2" type="text" ng-model="userEnd" placeholder="Destination" onfocus="geolocate()">
                </label>
                <br>


                <ion-list class="choice">
                  <ion-radio ng-model="choice" ng-value="'pedestrian'" ><i class="ion-android-walk"> Walking</i></ion-radio>
                  <ion-radio ng-model="choice" ng-value="'publicTransportTimeTable'"><i class="ion-android-subway"> Public Transport</i></ion-radio>
                </ion-list>
                <ul class="list">
                  <li class="item item-toggle"> Nightmode
                    <label class="toggle toggle-assertive">
                      <input type="checkbox">
                      <div class="track">
                        <div class="handle"></div>
                      </div>
                    </label>
                  </li>
                </ul>

                <button class='button button-block button-medium' id="request-coord" ng-click="ctrl.routeGenerator('starttext=' + userStart + '&endtext=' + userEnd + '&type=' + choice )"> Get Route </button>
              </div>
            </div>
          </div>
          <script>
            var autocomplete;

            function initAutocomplete() {
              var acInputs = document.getElementsByClassName("autocomplete");

              for (var i = 0; i < acInputs.length; i++) {
                var autocomplete = new google.maps.places.Autocomplete(acInputs[i]);
                autocomplete.inputId = acInputs[i].id;
              }
            }

            function geolocate() {
              if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                  var geolocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                  };
                  var circle = new google.maps.Circle({
                    center: geolocation,
                    radius: position.coords.accuracy
                  });
                  autocomplete.setBounds(circle.getBounds());
                });
              }
            }
          </script>
          <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeDWP97EV9nfUm4RhpWyVZ0fsTT9hBHgs&libraries=places&callback=initAutocomplete" async defer></script>
        </div>
      </body>
    </ion-content>
  </ion-view>
</html>
